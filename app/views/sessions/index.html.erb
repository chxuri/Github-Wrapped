<!DOCTYPE html>
<html>
  <head>
    <title>GitHub Wrapped</title>
    <div class="bod">
        <% if logged_in? %>
            <%= button_to "Log out", logout_path, method: :delete%>
            <p>You're logged in YAY!</p>
            <% if @repos.present? %>
                <p>Repositories created in 2025:</p>
                <% @repos.each do |repo| %>
                    <% if repo["created_at"][0,4] == "2025" %>
                        <p><%= repo["name"]%></p>
                    <% end %>
                <% end %>
            
            
                <% latestRepo = @repos.first%>
                <% latestMonth = @repos.first["updated_at"][5,2] %>
                <% latestDay = @repos.first["updated_at"][8, 2] %>
            
            <!--
            <% latestRepo = "me" %>
            <% latestMonth = "00" %>
            <% latestDay = "00" %>
            -->

                <% @repos.each do |repo| %>
                    <% if repo["updated_at"][5,7].to_i > latestMonth.to_i %>
                        <% latestRepo = repo %>
                        <% latestMonth = repo["updated_at"][5,2] %>
                        <% latestDay = repo["updated_at"][8, 2] %>
                    <% elsif repo["updated_at"][5,2].to_i == latestMonth.to_i && repo["updated_at"][8, 2].to_i > latestDay.to_i%>
                        <% latestRepo = repo %>
                        <% latestMonth = repo["updated_at"][5,2] %>
                        <% latestDay = repo["updated_at"][8, 2] %>
                    <% end %>
                <%end%>
            <!--
            <p>loopCounter: <%= @loopCounter %><p>
            <p>year: <%= @commitCheck %><p>
            -->
                <p>Latest worked on repository: <%= latestRepo["name"] %><p>
                <p>Most committed repository: <%= @mostCommitted["name"]%> (<%= @maxCommits %> commits total)
                <p>The longest time you spent on a repository this year was <%= @longestTimeRepo["name"]%> for <%= (@mostTime/60).to_i %> hours and <%= @mostTime % 60 %> minutes</p>
                <p><%= @debugger %></p>
            <% else %>
                <p> No repos found :( </p>
            <% end %>
            <!--
            <%= debug(@onePageTest) %>
            -->
        <% else %>
            <%= link_to "Sign in with GitHub", auth_path%>
            <p>Not logged in yet :(</p>
        <% end %>
    </div>
</head>


